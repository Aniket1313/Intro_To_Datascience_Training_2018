---
title: "capstone - statistics"
input: "bank_full_clean.csv"
---

```{R}
library(readr)
bank_full_clean <- read_csv("C:/Users/Alan/Desktop/bank_full_clean.csv")

# Explore the dataset with summary and str
str(bank_full_clean)
bank_numerical<-bank_full_clean[,c(2,7,11,13,14,15,16)]
bank_categorical<-bank_full_clean[,-c(1,2,7,11,13,14,15,16)]
summary(bank_numerical)

# Age histogram and removing outliers
library(ggplot2)
ggplot(bank_full_clean, aes(x=age)) + geom_histogram(binwidth = 5)
bank <- bank_full_clean[bank_full_clean$age <= 60 & bank_full_clean$age >= 25, ] 
plotseries<-function(yvar){
ggplot(bank, aes(x=age,fill = factor(yvar))) + geom_histogram(binwidth = 5)
}
lapply(bank[,c(3:6,8,9,17,18)], plotseries)

# Cleanup outliers
bank <- bank_full_clean[bank_full_clean$age <= 60 & bank_full_clean$age >= 25, ] 

##Crosstab - normal way
#create two dimensional tab
bank.tab<-table(bank$prev_outcome,bank$outcome_term_deposit)

#row marginal
margin.table(bank.tab,1)

#column marginal
margin.table(bank.tab,2) 

#cell %
round(prop.table(bank.tab),2)

#row %
round(prop.table(bank.tab,1),2) 

#column %
round(prop.table(bank.tab,2),2) 

#Chi-squared test
chisq.test(bank.tab)

#correlation through pairs function
pairs(bank_numerical)
``
